import{d as D,o as P,c as g,a as u,b as t,w as o,u as R,r as d,e as r,f as q,g as p,h as i,F as U,i as w,j as C,k as F,l as G}from"./index-okdrDDuw.js";import{useAuthStore as K}from"./auth-Y0P-C008.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Bz-GYz9Z.js";const O={class:"login-container"},$={class:"login-card-wrapper"},H={style:{"text-align":"center"}},J={style:{"margin-top":"4px"}},Q={key:0,style:{"text-align":"center",padding:"24px 0"}},W={style:{"margin-top":"12px"}},X={key:0,style:{"margin-bottom":"20px"}},Y={style:{"text-align":"center","margin-top":"6px"}},Z={style:{"text-align":"center"}},ee=D({__name:"Login",setup(te){const m=R(),I=q(),c=K(),L=d(null),b=d(!0),f=d(!1),y=d(!1),k=d(!1),a=d(""),s=d({username:"",password:""}),N={username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",trigger:"blur"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"}]},v=()=>I.query.redirect||"/";P(async()=>{if(c.isLoggedIn){m.replace(v());return}try{if(await c.autoAuth()){m.replace(v());return}}catch{}const l=localStorage.getItem("token");f.value=!!l,b.value=!1});async function T(){var l,e;y.value=!0,a.value="";try{if(!localStorage.getItem("token")){a.value="æœªæ£€æµ‹åˆ°ä¸»é¡¹ç›®ç™»å½•ä¿¡æ¯ï¼Œè¯·å…ˆåœ¨ä¸»é¡¹ç›®ä¸­ç™»å½•";return}await c.autoAuth()?m.replace(v()):(a.value="ä¸»é¡¹ç›® token å·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•ä¸»é¡¹ç›®",f.value=!1)}catch(n){a.value=((e=(l=n.response)==null?void 0:l.data)==null?void 0:e.detail)||n.message||"ç™»å½•å¤±è´¥"}finally{y.value=!1}}async function x(){var l,e;k.value=!0,a.value="";try{await c.adminLogin(s.value.username,s.value.password),m.replace(v())}catch(n){a.value=((e=(l=n.response)==null?void 0:l.data)==null?void 0:e.detail)||"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"}finally{k.value=!1}}return(l,e)=>{const n=r("n-text"),z=r("n-spin"),h=r("n-button"),M=r("n-divider"),S=r("n-input"),A=r("n-form-item"),V=r("n-form"),j=r("n-alert"),B=r("n-card");return p(),g("div",O,[u("div",$,[t(B,{class:"login-card",bordered:!1},{header:o(()=>[u("div",H,[e[5]||(e[5]=u("div",{style:{"font-size":"48px","margin-bottom":"8px"}},"ðŸ—ï¸",-1)),t(n,{style:{"font-size":"22px","font-weight":"700",color:"#e94560"}},{default:o(()=>[...e[3]||(e[3]=[i(" GoldenNest Studio ",-1)])]),_:1}),u("div",J,[t(n,{depth:"3",style:{"font-size":"13px"}},{default:o(()=>[...e[4]||(e[4]=[i("è®¾è®¡é™¢ Â· AI é©±åŠ¨è¿­ä»£å¼€å‘",-1)])]),_:1})])])]),footer:o(()=>[u("div",Z,[t(n,{depth:"3",style:{"font-size":"11px"}},{default:o(()=>[...e[11]||(e[11]=[i(" é¦–æ¬¡éƒ¨ç½²è¯·åœ¨çŽ¯å¢ƒå˜é‡ä¸­é…ç½® STUDIO_ADMIN_PASS ",-1)])]),_:1})])]),default:o(()=>[b.value?(p(),g("div",Q,[t(z,{size:"medium"}),u("div",W,[t(n,{depth:"3"},{default:o(()=>[...e[6]||(e[6]=[i("æ­£åœ¨æ£€æµ‹ç™»å½•çŠ¶æ€...",-1)])]),_:1})])])):(p(),g(U,{key:1},[f.value?(p(),g("div",X,[t(h,{type:"info",block:"",size:"large",loading:y.value,onClick:T},{default:o(()=>[...e[7]||(e[7]=[i(" ðŸ”— ä½¿ç”¨ä¸»é¡¹ç›®è´¦æˆ·ç™»å½• ",-1)])]),_:1},8,["loading"]),u("div",Y,[t(n,{depth:"3",style:{"font-size":"12px"}},{default:o(()=>[...e[8]||(e[8]=[i(" æ£€æµ‹åˆ°ä¸»é¡¹ç›® (GoldenNest) ç™»å½•æ€ï¼Œç‚¹å‡»ä¸€é”®è¿›å…¥ ",-1)])]),_:1})])])):w("",!0),f.value?(p(),C(M,{key:1,"title-placement":"center"},{default:o(()=>[t(n,{depth:"3",style:{"font-size":"12px"}},{default:o(()=>[...e[9]||(e[9]=[i("æˆ–",-1)])]),_:1})]),_:1})):w("",!0),t(V,{ref_key:"formRef",ref:L,model:s.value,rules:N,onSubmit:F(x,["prevent"])},{default:o(()=>[t(A,{label:"ç”¨æˆ·å",path:"username"},{default:o(()=>[t(S,{value:s.value.username,"onUpdate:value":e[0]||(e[0]=_=>s.value.username=_),placeholder:"ç®¡ç†å‘˜ç”¨æˆ·å",size:"large"},null,8,["value"])]),_:1}),t(A,{label:"å¯†ç ",path:"password"},{default:o(()=>[t(S,{value:s.value.password,"onUpdate:value":e[1]||(e[1]=_=>s.value.password=_),type:"password",placeholder:"ç®¡ç†å‘˜å¯†ç ",size:"large","show-password-on":"click",onKeyup:G(x,["enter"])},null,8,["value"])]),_:1}),t(h,{type:"primary",block:"",size:"large",loading:k.value,disabled:!s.value.username||!s.value.password,onClick:x},{default:o(()=>[...e[10]||(e[10]=[i(" ðŸ”‘ ç®¡ç†å‘˜ç™»å½• ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["model"]),a.value?(p(),C(j,{key:2,type:"error",title:a.value,style:{"margin-top":"16px"},closable:"",onClose:e[2]||(e[2]=_=>a.value="")},null,8,["title"])):w("",!0)],64))]),_:1})])])}}}),le=E(ee,[["__scopeId","data-v-ea0f2d33"]]);export{le as default};
